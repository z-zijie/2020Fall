\documentclass{article}
% --- Modify margins --- %
\usepackage{geometry}
\geometry{a4paper,scale=0.8}
% --- Involved packages --- %
\usepackage{amssymb}
\usepackage{amsthm}
\usepackage{amsmath}
\usepackage{bm}
\usepackage{graphicx}
\usepackage{physics}

% --- NewCommand --- %
% \newcommand{\norm}[1]{\left\lVert#1\right\rVert}

% --- Title information --- %
\title{CS 760: Machine Learning - Fall 2020\\
        {\Large \textbf{Homework 2: Linear Regression}}\\
        {\normalsize \textbf{Due : 10/13/2020}}
    }
\author{Zijie Zhang}
\date{\today}


% --- main --- %

\begin{document}
    \maketitle
    
% --- Problem 1 ---%
\section*{Problem 1}
    \begin{proof}
    We notice that:
    \begin{align*}
        \norm{\vb{y-X\bm{\theta}}}_2^2
        &=(\vb{y-X\bm{\theta}})^T (\vb{y-X\bm{\theta}})\\
        &=\vb{y^Ty}-2\bm{\theta}^T\vb{X}^T\vb{y}+\bm{\theta}^T\vb{X}^T\vb{X}\bm{\theta}
    \end{align*}
    Compute the differential:
    \begin{align*}
        \text{d}\tr\left(\vb{y}^T\vb{y}-2\bm{\theta}^T\vb{X}^T\vb{y}+\bm{\theta}^T\vb{X}^T\vb{X}\bm{\theta}\right)
        &= -2\tr\left((\text{d}\bm{\theta})^T \vb{X}^T \vb{y}\right)
            +\tr\left((\text{d}\bm{\theta})^T \vb{X}^T\vb{X}\bm{\theta}\right)
            +\tr\left(\bm{\theta}^T \vb{X}^T\vb{X} (\text{d}\bm{\theta})\right)\\
        &= 2\tr\left((\text{d}\bm{\theta})^T(\vb{X}^T\vb{X}\bm{\theta}-\vb{X}^T y)\right)
    \end{align*}
    It follows that
    $$\frac{\text{d}}{\text{d}\bm{\theta}}=2\vb{X}^T\vb{X}\bm{\theta}-2\vb{X}^T y$$
    Let this derivative to zero, we have
    $$\arg{\min_\theta}=\left(\vb{X}^T\vb{X}\right)^{-1}\vb{X}^T\vb{y}$$
    \end{proof}

% --- Problem 2 ---%
\section*{Problem 2}
    \begin{proof}
    We know that $$\vb*{y}\sim \mathcal{N}\left(\vb{X}\bm{\theta}^*, \bm{\Sigma}^*\right)$$ Then
    $$ \mathbb{P}\left(\vb{y},\vb{X}|\bm{\theta},\bm{\Sigma}^*\right)
    =\frac{1}{\sqrt{(2\pi)^N |\bm{\Sigma}^*|^{\frac{1}{N}}}}\exp{-\frac{1}{2}\left(\vb{y}-\vb{X}\bm{\theta}\right)^T{\bm{\Sigma}^*}^{-1}\left(\vb{y}-\vb{X}\bm{\theta}\right)} $$
    \begin{align*}
        \bm{\hat{\theta}} &= \arg{\max_{\bm{\theta}}\mathbb{P}\left(\vb{y},\vb{X}|\bm{\theta},\bm{\Sigma}^*\right)}\\
        &=\arg{\max_{\bm{\theta}}\frac{1}{\sqrt{(2\pi)^N |\bm{\Sigma}^*|^{\frac{1}{N}}}}\exp{-\frac{1}{2}\left(\vb{y}-\vb{X}\bm{\theta}\right)^T{\bm{\Sigma}^*}^{-1}\left(\vb{y}-\vb{X}\bm{\theta}\right)}}\\
        &=\arg{\max_{\bm{\theta}}-\left(\vb{y}-\vb{X}\bm{\theta}\right)^T{\bm{\Sigma}^*}^{-1}\left(\vb{y}-\vb{X}\bm{\theta}\right)}\\
        &=\arg{\min_{\bm{\theta}}\left(\vb{y}-\vb{X}\bm{\theta}\right)^T{\bm{\Sigma}^*}^{-1}\left(\vb{y}-\vb{X}\bm{\theta}\right)}
    \end{align*}
    Compute the differential:
    $$\frac{\text{d}}{\text{d}\bm{\theta}}=2\vb{X}^T {\bm{\Sigma}^*}^{-1} \vb{X}\bm{\theta}-2\vb{X}^T {\bm{\Sigma}^*}^{-1} y$$
    $$\bm{\hat{\theta}} = \left(\vb{X}^T{\bm{\Sigma}^*}^{-1}\vb{X}\right)^{-1}\vb{X}^T {\bm{\Sigma}^*}^{-1} y$$
    \end{proof}

% --- Problem 3 ---%
\section*{Problem 3}
    \begin{proof}
        $$\bm{\hat{\theta}} \sim \mathcal{N}\left(\bm{\theta}^*,|\bm{\Sigma}^*|^{\frac{1}{N}}\left(\vb{X}^T\vb{X}\right)^{-1}\right)$$
    \end{proof}

% --- Problem 4 ---%
\section*{Problem 4}
    \begin{proof}
        $$\vb{\hat{y}}=\vb{x}^T\bm{\hat{\theta}}=\vb{x}^T\left(\vb{X}^T{\bm{\Sigma}^*}^{-1}\vb{X}\right)^{-1}\vb{X}^T{\bm{\Sigma}^*}^{-1}\vb{y}$$
    \end{proof}

% --- Problem 5 ---%
\section*{Problem 5}
    \begin{proof}
        $$\vb*{\hat{y}} \sim \mathcal{N}\left(\vb{x}^T \bm{\theta}^*,\vb{x}^T |\bm{\Sigma}^*|^{\frac{1}{N}}\left(\vb{X}^T\vb{X}\right)^{-1} \vb{x} \right)$$
    \end{proof}

% --- Problem 6 ---%
\section*{Problem 6}
    \begin{proof}
        
    \end{proof}

% --- Problem 7 ---%
\section*{Problem 7}
    \begin{proof}
        
    \end{proof}



\end{document}